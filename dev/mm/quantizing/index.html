<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantizing &amp; Humanizing · JuliaMusic</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="JuliaMusic logo"/></a><div class="docs-package-name"><span class="docs-autofit">JuliaMusic</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../midi/io/">Basic MIDI structures</a></li><li><a class="tocitem" href="../../midi/notes/">Notes</a></li><li><a class="tocitem" href="../notetools/">Note Tools</a></li><li class="is-active"><a class="tocitem" href>Quantizing &amp; Humanizing</a><ul class="internal"><li><a class="tocitem" href="#Quantization"><span>Quantization</span></a></li><li><a class="tocitem" href="#Classification"><span>Classification</span></a></li><li><a class="tocitem" href="#Humanizing"><span>Humanizing</span></a></li></ul></li><li><a class="tocitem" href="../extraction/">Music data extraction</a></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../printplot/noteplotter/">Plotting notes</a></li><li><a class="tocitem" href="../../printplot/musescore/">Printing notes into a score</a></li></ul></li><li><span class="tocitem">Motif sequence</span><ul><li><a class="tocitem" href="../../motif/basic/">Motif sequence generator</a></li><li><a class="tocitem" href="../../motif/musicexample/">Music motifs</a></li></ul></li><li><span class="tocitem">Becoming a better drummer blog</span><ul><li><a class="tocitem" href="../../blog/drumpatterns/">Ep. 1 - Mixing drum patterns</a></li><li><a class="tocitem" href="../../blog/garibaldi_dragadiddle/">Ep. 2 - Garibaldi inspired dragaddidle</a></li><li><a class="tocitem" href="../../blog/gaddisms/">Ep. 3 - Gaddisms</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quantizing &amp; Humanizing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quantizing &amp; Humanizing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMusic/JuliaMusic_documentation.jl/blob/master/docs/src/mm/quantizing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quantizing-and-Humanizing"><a class="docs-heading-anchor" href="#Quantizing-and-Humanizing">Quantizing &amp; Humanizing</a><a id="Quantizing-and-Humanizing-1"></a><a class="docs-heading-anchor-permalink" href="#Quantizing-and-Humanizing" title="Permalink"></a></h1><h2 id="Quantization"><a class="docs-heading-anchor" href="#Quantization">Quantization</a><a id="Quantization-1"></a><a class="docs-heading-anchor-permalink" href="#Quantization" title="Permalink"></a></h2><p><em>Quantization</em> is the process of moving all note starting positions to a specified and periodic grid. This &quot;grid&quot; does not have the be equi-spaced but it has to be periodic per quarter note.</p><article class="docstring"><header><a class="docstring-binding" id="MusicManipulations.quantize" href="#MusicManipulations.quantize"><code>MusicManipulations.quantize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">quantize(notes::Notes, grid, duration = true)
quantize(note::AbstractNote, grid, tpq::Integer)</code></pre><p>Return a quantized copy of the given notes on the given <code>grid</code>, which can be any sorted iterable that starts on <code>0</code> and ends on <code>1</code>.</p><p>Each note is quantized (relocated) to its closest point of the <code>grid</code>, by first identifying that point using <a href="#MusicManipulations.classify"><code>classify</code></a>. It is assumed that the grid is the same for all quarter notes of the track.</p><p>If <code>duration</code> is <code>true</code>, the function also quantizes the duration of the notes on the same grid, while ensuring a duration spanning at least one grid point.</p><p>This function respects the notes&#39; absolute position and quantizes in absolute position, not relative.</p></div></section></article><hr/><p>Here are some examples</p><pre><code class="language-julia">using MusicManipulations
midi = readMIDIFile(testmidi())
notes = getnotes(midi, 4)

sixteens = 0:1//4:1

notes16 = quantize(notes, sixteens)

swung_8s = [0, 2//3, 1]

swung_notes = quantize(notes, swung_8s)</code></pre><pre class="documenter-example-output">533 Notes with tpq=960
 Note F4  | vel = 69  | pos = 7360, dur = 320
 Note A♯4 | vel = 85  | pos = 7680, dur = 640
 Note D5  | vel = 91  | pos = 8320, dur = 320
 Note D4  | vel = 88  | pos = 8320, dur = 320
 Note G♯3 | vel = 88  | pos = 8320, dur = 320
 Note A♯4 | vel = 76  | pos = 8640, dur = 640
 Note G4  | vel = 66  | pos = 9280, dur = 320
  ⋮
 Note D5  | vel = 91  | pos = 189760, dur = 320
 Note D5  | vel = 106 | pos = 190720, dur = 320
 Note A4  | vel = 99  | pos = 190720, dur = 320
 Note D♯4 | vel = 101 | pos = 190720, dur = 960
 Note A3  | vel = 106 | pos = 190720, dur = 960
 Note D4  | vel = 106 | pos = 190720, dur = 960
 Note G4  | vel = 109 | pos = 190720, dur = 320</pre><p>The first quantization quantized the notes on the 16-th subdivision. The second one did something a bit more specialized, as it separated the notes to &quot;quarter notes&quot; and swung 8th notes, the typical way a Jazz standard (like Serenade To A Cuckoo) is played.</p><h2 id="Classification"><a class="docs-heading-anchor" href="#Classification">Classification</a><a id="Classification-1"></a><a class="docs-heading-anchor-permalink" href="#Classification" title="Permalink"></a></h2><p><a href="#MusicManipulations.quantize"><code>quantize</code></a> works in two steps. In the first step, each note is &quot;classified&quot;, according to which is the closest grid point to this note (modulo the quarter note).</p><article class="docstring"><header><a class="docstring-binding" id="MusicManipulations.classify" href="#MusicManipulations.classify"><code>MusicManipulations.classify</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">classify(notes::Notes, grid)
classify(note::AbstractNote, grid, tpq::Integer)</code></pre><p>Classify given notes according to the given grid.</p><p>Returns an integer (or vector of integers) that corresponds to the index of the closest grid point to the note position modulo the quarter note. <code>1</code> means start of the grid and <code>length(grid)</code> means end of the grid (i.e. <em>next</em> quarter note).</p></div></section></article><p>After the notes have been classified, this classification vector is used to simply relocate all notes to the closest grid point (modulo the quarter note).</p><h2 id="Humanizing"><a class="docs-heading-anchor" href="#Humanizing">Humanizing</a><a id="Humanizing-1"></a><a class="docs-heading-anchor-permalink" href="#Humanizing" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MusicManipulations.humanize!" href="#MusicManipulations.humanize!"><code>MusicManipulations.humanize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">humanize!(notes, property, σ, noise = :ARFIMA; kwargs...)</code></pre><p>Humanize given <code>notes</code> by adding noise of standard deviation <code>σ</code> to their <code>property</code>, typically either <code>:position</code> or <code>:velocity</code>. Research<sup class="footnote-reference"><a id="citeref-Datseris2019" href="#footnote-Datseris2019">[Datseris2019]</a></sup> suggests that <code>σ</code> should be around 40 (for <code>:position</code>) but that depends on the BPM, and around 10 for <code>:velocity</code>.</p><p>The <code>noise</code> argument decides the type of noise:</p><ul><li><code>:ARFIMA</code> uses ARFIMA.jl and attempts to generate a power-law correlated (pink) noise. Keywords <code>d = 0.25, φ = SVector(-0.5, -1.5)</code> are propagated to function <code>arfima</code>.</li><li><code>:white</code> plain ol&#39; white noise.</li></ul><p>Use <code>humanize</code> for a non-modifying version.</p></div></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Datseris2019"><a class="tag is-link" href="#citeref-Datseris2019">Datseris2019</a>Datseris, G., et al. <a href="https://doi.org/10.1038/s41598-019-55981-3">Microtiming Deviations and Swing Feel in Jazz. Sci Rep 9, 19824 (2019)</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../notetools/">« Note Tools</a><a class="docs-footer-nextpage" href="../extraction/">Music data extraction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 18 April 2021 09:47">Sunday 18 April 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
