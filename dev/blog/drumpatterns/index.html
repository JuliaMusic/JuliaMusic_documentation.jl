<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ep. 1 - Mixing drum patterns · JuliaMusic</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="JuliaMusic logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuliaMusic</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../midi/io/">Basic MIDI structures</a></li><li><a class="tocitem" href="../../midi/notes/">Notes</a></li><li><a class="tocitem" href="../../mm/notetools/">Note Tools</a></li><li><a class="tocitem" href="../../mm/quantizing/">Quantizing &amp; Humanizing</a></li><li><a class="tocitem" href="../../mm/extraction/">Music data extraction</a></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../printplot/noteplotter/">Plotting notes</a></li><li><a class="tocitem" href="../../printplot/musescore/">Printing notes into a score</a></li></ul></li><li><span class="tocitem">Motif sequence</span><ul><li><a class="tocitem" href="../../motif/basic/">Motif sequence generator</a></li><li><a class="tocitem" href="../../motif/musicexample/">Music motifs</a></li></ul></li><li><span class="tocitem">Becoming a better drummer blog</span><ul><li class="is-active"><a class="tocitem" href>Ep. 1 - Mixing drum patterns</a><ul class="internal"><li><a class="tocitem" href="#Defining-the-Notes"><span>Defining the <code>Notes</code></span></a></li><li><a class="tocitem" href="#Adding-alternating-hands-and-Lyrics"><span>Adding alternating hands and Lyrics</span></a></li></ul></li><li><a class="tocitem" href="../garibaldi_dragadiddle/">Ep. 2 - Garibaldi inspired dragaddidle</a></li><li><a class="tocitem" href="../gaddisms/">Ep. 3 - Gaddisms</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Becoming a better drummer blog</a></li><li class="is-active"><a href>Ep. 1 - Mixing drum patterns</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Ep. 1 - Mixing drum patterns</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMusic/JuliaMusic_documentation.jl/blob/master/docs/src/blog/drumpatterns.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Mixing-basic-drum-patterns"><a class="docs-heading-anchor" href="#Mixing-basic-drum-patterns">Mixing basic drum patterns</a><a id="Mixing-basic-drum-patterns-1"></a><a class="docs-heading-anchor-permalink" href="#Mixing-basic-drum-patterns" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This page is also available as a YouTube video here: <a href="https://youtu.be/Oog_aunpVms">https://youtu.be/Oog_aunpVms</a></p></div></div><hr/><p>Let&#39;s say that we have some basic drum patterns that we want to be able to combine freely at random combinations. For example,</p><p><img src="../basic_motifs.PNG" alt="Basic drum patterns"/></p><p>where the note E means right hand, while A means left hand. These patterns can be easily combined to fill a bar, for example <code>5b -&gt; 5b -&gt; 3 -&gt; 3</code> or <code>5a -&gt; 4 -&gt; 4 -&gt; 3</code>, etc. They can also be combined to fill two bars and so on. Notice that some sequences, like e.g. the <code>5a -&gt; 4 -&gt; 4 -&gt; 3</code>, result in <em>alternating hands</em>: each time the sequence is played the hand that &quot;leads&quot; is swapped. This will be important later on.</p><p>The goal is to be able to play arbitrary sequences of them for arbitrary lengths. How does one practice that? We will use <a href="../../motif/musicexample/#MusicManipulations.random_notes_sequence"><code>random_notes_sequence</code></a> to create longer 8-bar sequences faster with the help of Julia.</p><h2 id="Defining-the-Notes"><a class="docs-heading-anchor" href="#Defining-the-Notes">Defining the <code>Notes</code></a><a id="Defining-the-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-Notes" title="Permalink"></a></h2><p>We first have to define the <code>Notes</code> instances that will correspond to those four basic patterns.</p><pre><code class="language-julia hljs">using MusicManipulations, MusicVisualizations

tpq = 960 # ticks per quarter note
sixt = 240 # duration of sixteenth note
left = name_to_pitch(&quot;A5&quot;)
right = name_to_pitch(&quot;E6&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">88</code></pre><p>Reminder: <code>Note(pitch, intensity, start, duration)</code></p><pre><code class="language-julia hljs">motif1 = [ # motif 5a
Note(right, 100, 0, sixt),
Note(left, 50, sixt, sixt),
Note(right, 100, 2sixt, sixt),
Note(left, 50, 3sixt, sixt),
Note(left, 50, 4sixt, sixt)
]

motif2 = [ # motif 5b
Note(right, 100, 0, sixt),
Note(left, 50, sixt, sixt),
Note(left, 50, 2sixt, sixt),
Note(right, 50, 3sixt, sixt),
Note(right, 50, 4sixt, sixt)
]

motif3 = [ # motif 3
Note(right, 100, 0, sixt),
Note(left, 50, sixt, sixt),
Note(left, 50, 2sixt, sixt),
]

motif4 = [ # motif 4
Note(right, 100, 0, sixt),
Note(left, 50, sixt, sixt),
Note(right, 50, 2sixt, sixt),
Note(right, 50, 3sixt, sixt),
]

motifs = Notes.([motif1, motif2, motif3, motif4], tpq)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Notes{Note}}:
 Notes{Note} with 5 notes
 Notes{Note} with 5 notes
 Notes{Note} with 3 notes
 Notes{Note} with 4 notes</code></pre><p>Now <code>motifs</code> stands for a pool of note sequences we can draw random samples from. Let&#39;s generate sequences that are 8-bars long (i.e. 32 quarter notes)</p><pre><code class="language-julia hljs">q = tpq*32

notes, seq = random_notes_sequence(motifs, q)
notes</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">128 Notes with tpq=960
 Note E6  | vel = 100 | pos = 0, dur = 240
 Note A5  | vel = 50  | pos = 240, dur = 240
 Note A5  | vel = 50  | pos = 480, dur = 240
 Note E6  | vel = 100 | pos = 720, dur = 240
 Note A5  | vel = 50  | pos = 960, dur = 240
 Note E6  | vel = 100 | pos = 1200, dur = 240
 Note A5  | vel = 50  | pos = 1440, dur = 240
  ⋮
 Note E6  | vel = 50  | pos = 29040, dur = 240
 Note E6  | vel = 50  | pos = 29280, dur = 240
 Note E6  | vel = 100 | pos = 29520, dur = 240
 Note A5  | vel = 50  | pos = 29760, dur = 240
 Note A5  | vel = 50  | pos = 30000, dur = 240
 Note E6  | vel = 50  | pos = 30240, dur = 240
 Note E6  | vel = 50  | pos = 30480, dur = 240</code></pre><p>and now we can write these to a MIDI file simply by doing <code>save(&quot;drums_patterns.mid&quot;, notes)</code> if we want to. We can also use <a href="https://musescore.org">MuseScore</a>, to visualize and print the result. The function <a href="../../printplot/musescore/#MusicVisualizations.musescore"><code>musescore</code></a> provides this interface.</p><pre><code class="language-julia hljs">musescore(&quot;drums_patterns.png&quot;, notes)</code></pre><p><img src="../drums_patterns-1.png" alt="32-bar pattern sequence"/></p><p><em>this is a pre-made figure - your random sequence will probably differ</em></p><p>This worked nicely, but there is a problem: The sequence does not respect the fact that some specific patterns (<code>5b</code> and <code>4</code>) swap the leading hand. This is what we tackle in the next section.</p><h2 id="Adding-alternating-hands-and-Lyrics"><a class="docs-heading-anchor" href="#Adding-alternating-hands-and-Lyrics">Adding alternating hands and Lyrics</a><a id="Adding-alternating-hands-and-Lyrics-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-alternating-hands-and-Lyrics" title="Permalink"></a></h2><p>Notice that <code>random_note_sequence</code> also returns the indices of the motifs that were used to create the sequence:</p><pre><code class="language-julia hljs">seq</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">29-element Vector{Int64}:
 3
 1
 1
 3
 3
 3
 1
 1
 4
 1
 ⋮
 2
 2
 1
 3
 1
 2
 2
 4
 2</code></pre><p>We can use this information to put the correct &quot;stickings&quot;. To alternate hands we simply need to replace the necessary E notes with A and vice versa. Let&#39;s define some &quot;meta-data&quot; like structures</p><pre><code class="language-julia hljs">accent1 = (&quot;5a&quot;, false)
accent2 = (&quot;5b&quot;, true)
accent3 = (&quot;3&quot;, false)
accent4 = (&quot;4&quot;, true)
accents = [accent1, accent2, accent3, accent4]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Tuple{String, Bool}}:
 (&quot;5a&quot;, 0)
 (&quot;5b&quot;, 1)
 (&quot;3&quot;, 0)
 (&quot;4&quot;, 1)</code></pre><p>The first entry of each tuple is simply the name of the pattern which we will also show in our music score as &quot;lyrics&quot;. The second entry of the tuple simply denotes whether the pattern swaps the leading hand.</p><p>The function that will &quot;inverse&quot; a note sticking is:</p><pre><code class="language-julia hljs">inverse!(n::Note) = (n.pitch = (n.pitch == left ? right : left));</code></pre><p>The function that will &quot;count&quot; how long is each pattern, so that we put the lyrics on the correct positions in the score, will be:</p><pre><code class="language-julia hljs">note_length(s::String) = parse(Int, s[1]);</code></pre><p>(remember: <code>sixt</code> is the duration of one sixteenth note). We now initialize an empty <a href="../../midi/io/#MIDI.MIDITrack"><code>MIDITrack</code></a> and add all events to it!</p><pre><code class="language- hljs">track = MIDITrack()
ℓ = 0
right_leads = true

for i in 1:length(seq)

    s = accents[seq[i]][1]
    le = MIDI.LyricEvent(0, MIDI.LYRICEV, s)
    addevent!(track, ℓ*sixt, le)

    if !right_leads # Invert notes
        for j in ℓ+1:ℓ+note_length(s)
            inverse!(notes[j])
        end
    end

    global ℓ += note_length(s)

    change = accents[seq[i]][2]
    global right_leads = xor(right_leads, change)
end

addnotes!(track, notes)
notes</code></pre><p>Finally, to visualize, we use <a href="../../printplot/musescore/#MusicVisualizations.musescore"><code>musescore</code></a> again, using a midi file as an input</p><pre><code class="language-julia hljs">musescore(&quot;drums_patterns_with_names.png&quot;, MIDIFile(1, 960, [track]))</code></pre><p><img src="../drums_patterns_with_names-1.png" alt="Correct 32-bar pattern sequence"/></p><p>Isn&#39;t it cool that even the lyrics text was displayed so seamlessly?</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../motif/musicexample/">« Music motifs</a><a class="docs-footer-nextpage" href="../garibaldi_dragadiddle/">Ep. 2 - Garibaldi inspired dragaddidle »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Wednesday 20 October 2021 13:21">Wednesday 20 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
