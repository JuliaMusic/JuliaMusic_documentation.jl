<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Motif sequence generator · JuliaMusic</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="JuliaMusic logo"/></a><div class="docs-package-name"><span class="docs-autofit">JuliaMusic</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../midi/io/">Basic MIDI structures</a></li><li><a class="tocitem" href="../../midi/notes/">Notes</a></li><li><a class="tocitem" href="../../mm/notetools/">Note Tools</a></li><li><a class="tocitem" href="../../mm/quantizing/">Quantizing</a></li><li><a class="tocitem" href="../../mm/extraction/">Music data extraction</a></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../printplot/noteplotter/">Plotting notes</a></li><li><a class="tocitem" href="../../printplot/musescore/">Printing notes into a score</a></li></ul></li><li><span class="tocitem">Motif sequence</span><ul><li class="is-active"><a class="tocitem" href>Motif sequence generator</a><ul class="internal"><li><a class="tocitem" href="#Simple-Example-1"><span>Simple Example</span></a></li><li><a class="tocitem" href="#Floating-point-lengths-1"><span>Floating point lengths</span></a></li></ul></li><li><a class="tocitem" href="../musicexample/">Music motifs</a></li></ul></li><li><span class="tocitem">Becoming a better drummer blog</span><ul><li><a class="tocitem" href="../../blog/drumpatterns/">Ep. 1 - Mixing drum patterns</a></li><li><a class="tocitem" href="../../blog/garibaldi_dragadiddle/">Ep. 2 - Garibaldi inspired dragaddidle</a></li><li><a class="tocitem" href="../../blog/gaddisms/">Ep. 3 - Gaddisms</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Motif sequence</a></li><li class="is-active"><a href>Motif sequence generator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Motif sequence generator</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMusic/JuliaMusic_documentation.jl/blob/master/docs/src/motif/basic.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Motif-sequence-generation-1"><a class="docs-heading-anchor" href="#Motif-sequence-generation-1">Motif sequence generation</a><a class="docs-heading-anchor-permalink" href="#Motif-sequence-generation-1" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="MotifSequenceGenerator" href="#MotifSequenceGenerator"><code>MotifSequenceGenerator</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">MotifSequenceGenerator</code></pre><p>This module generates random sequences of motifs, under the constrain that the sequence has some total length ℓ so that <code>q - δq ≤ ℓ ≤ q + δq</code>. All main functionality is given by the function <a href="#MotifSequenceGenerator.random_sequence"><code>random_sequence</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="MotifSequenceGenerator.random_sequence" href="#MotifSequenceGenerator.random_sequence"><code>MotifSequenceGenerator.random_sequence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">random_sequence(motifs::Vector{M}, q, limits, translate, δq = 0; kwargs...)</code></pre><p>Create a random sequence of motifs of type <code>M</code>, under the constraint that the sequence has &quot;length&quot; <code>ℓ</code> <strong>exactly</strong> within <code>q - δq ≤ ℓ ≤ q + δq</code>. Return the sequence itself as well as the sequence of indices of <code>motifs</code> used to create it. A vector of probabilities <code>weights</code> can be given as a keyword argument, which then dictates the sampling probability for each entry of <code>motifs</code> for the initial sequence created.</p><p>&quot;length&quot; here means an abstracted length defined by the struct <code>M</code>, based on the <code>limits</code> and <code>translate</code> functions. It does <strong>not</strong> refer to the amount of elements!</p><p><code>M</code> can be anything, given the two functions</p><ul><li><code>limits(motif)</code> : Some function that given the <code>motif</code> it returns the <code>(start, fine)</code> of the the motif in the same units as <code>q</code>. This function establishes a measure of length, which simply is <code>fine - start</code>.</li><li><code>translate(motif, t)</code> : Some function that given the <code>motif</code> it returns a <em>new</em> motif which is translated by <code>t</code> (either negative or positive), with respect to the same units as <code>q</code>.</li></ul><p><strong>Other Keywords</strong></p><p>Please see the source code (use <code>@which</code>) for a full description of the algorithm.</p><ul><li><code>tries = 5</code> : Up to how many initial random sequences are accepted.</li><li><code>taulcut = 2</code> : Up to how times an element is dropped from the initial guess.</li><li><code>summands = 3</code> : Up to how many motifs may be combined as a sum to complete a sequence.</li></ul></div></section></article><h2 id="Simple-Example-1"><a class="docs-heading-anchor" href="#Simple-Example-1">Simple Example</a><a class="docs-heading-anchor-permalink" href="#Simple-Example-1" title="Permalink"></a></h2><p>This example illustrates how the module <a href="#MotifSequenceGenerator"><code>MotifSequenceGenerator</code></a> works using a simple <code>struct</code>. For a more realistic, and much more complex example, see the <a href="../musicexample/">example using music notes</a>.</p><hr/><p>Let&#39;s say that we want to create a random sequence of &quot;shouts&quot;, which are described by the <code>struct</code></p><pre><code class="language-julia">struct Shout
  shout::String
  start::Int
end</code></pre><p>Let&#39;s first create a vector of shouts that will be used as the pool of possible motifs that will create the random sequence:</p><pre><code class="language-julia">using Random
shouts = [Shout(uppercase(randstring(rand(3:5))), rand(1:100)) for k in 1:5]</code></pre><pre><code class="language-none">5-element Array{Main.ex-shout.Shout,1}:
 Main.ex-shout.Shout(&quot;IB1&quot;, 12) 
 Main.ex-shout.Shout(&quot;G8BI&quot;, 18)
 Main.ex-shout.Shout(&quot;Z0AN&quot;, 88)
 Main.ex-shout.Shout(&quot;PSP&quot;, 56) 
 Main.ex-shout.Shout(&quot;TUJK&quot;, 52)</code></pre><p>Notice that at the moment the values of the <code>.start</code> field of <code>Shout</code> are irrelevant. <code>MotifSequenceGenerator</code> will translate all motifs to start point 0 while operating.</p><p>Now, to create a random sequence, we need to define two concepts:</p><pre><code class="language-julia">shoutlimits(s::Shout) = (s.start, s.start + length(s.shout) + 1);

shouttranslate(s::Shout, n) = Shout(s.shout, s.start + n);</code></pre><pre><code class="language-none">shouttranslate (generic function with 1 method)</code></pre><p>This means that we accept that the temporal length of a <code>Shout</code> is <code>length(s.shout) + 1</code>.</p><p>We can now create random sequences of shouts that have total length of <em>exactly</em> <code>q</code>:</p><pre><code class="language-julia">using MotifSequenceGenerator
q = 30
sequence, idxs = random_sequence(shouts, q, shoutlimits, shouttranslate)
sequence</code></pre><pre><code class="language-none">7-element Array{Main.ex-shout.Shout,1}:
 Main.ex-shout.Shout(&quot;TUJK&quot;, 0)
 Main.ex-shout.Shout(&quot;IB1&quot;, 5) 
 Main.ex-shout.Shout(&quot;G8BI&quot;, 9)
 Main.ex-shout.Shout(&quot;PSP&quot;, 14)
 Main.ex-shout.Shout(&quot;PSP&quot;, 18)
 Main.ex-shout.Shout(&quot;PSP&quot;, 22)
 Main.ex-shout.Shout(&quot;PSP&quot;, 26)</code></pre><pre><code class="language-julia">sequence, idxs = random_sequence(shouts, q, shoutlimits, shouttranslate)
sequence</code></pre><pre><code class="language-none">6-element Array{Main.ex-shout.Shout,1}:
 Main.ex-shout.Shout(&quot;Z0AN&quot;, 0) 
 Main.ex-shout.Shout(&quot;Z0AN&quot;, 5) 
 Main.ex-shout.Shout(&quot;TUJK&quot;, 10)
 Main.ex-shout.Shout(&quot;TUJK&quot;, 15)
 Main.ex-shout.Shout(&quot;Z0AN&quot;, 20)
 Main.ex-shout.Shout(&quot;G8BI&quot;, 25)</code></pre><p>Notice that it is impossible to create a sequence of length e.g. <code>7</code> with the above pool. Doing <code>random_sequence(shouts, 7, shoutlimits, shouttranslate)</code> would throw an error.</p><h2 id="Floating-point-lengths-1"><a class="docs-heading-anchor" href="#Floating-point-lengths-1">Floating point lengths</a><a class="docs-heading-anchor-permalink" href="#Floating-point-lengths-1" title="Permalink"></a></h2><p>The lengths of the motifs do not have to be integers. When using motifs with floating lengths, it is advised to give a non-0 <code>δq</code> to <a href="#MotifSequenceGenerator.random_sequence"><code>random_sequence</code></a>. The following example modifies the <code>Shout</code> struct and shows how it can be done with floating length.</p><pre><code class="language-julia">struct FloatShout
  shout::String
  dur::Float64
  start::Float64
end

rs(x) = uppercase(randstring(x))

shouts = [FloatShout(rs(rand(3:5)), rand()+1, rand()) for k in 1:5]
shoutlimits(s::FloatShout) = (s.start, s.start + s.dur);
shouttranslate(s::FloatShout, n) = FloatShout(s.shout, s.dur, s.start + n);

q = 10.0
δq = 1.0

r, s = random_sequence(shouts, q, shoutlimits, shouttranslate, δq)

r</code></pre><pre><code class="language-none">6-element Array{Main.ex-shout.FloatShout,1}:
 Main.ex-shout.FloatShout(&quot;OYE&quot;, 1.5261008222666494, 0.0)                
 Main.ex-shout.FloatShout(&quot;OYE&quot;, 1.5261008222666494, 1.5261008222666494) 
 Main.ex-shout.FloatShout(&quot;AB4BG&quot;, 1.9591676872377368, 3.052201644533299)
 Main.ex-shout.FloatShout(&quot;QMWF&quot;, 1.6959911606597895, 5.011369331771036) 
 Main.ex-shout.FloatShout(&quot;QMWF&quot;, 1.6959911606597895, 6.707360492430825) 
 Main.ex-shout.FloatShout(&quot;8CKJZ&quot;, 1.4385281211015883, 8.403351653090615)</code></pre><pre><code class="language-julia">s</code></pre><pre><code class="language-none">6-element Array{Int64,1}:
 3
 3
 1
 5
 5
 4</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../printplot/musescore/">« Printing notes into a score</a><a class="docs-footer-nextpage" href="../musicexample/">Music motifs »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 1 March 2020 21:00">Sunday 1 March 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
