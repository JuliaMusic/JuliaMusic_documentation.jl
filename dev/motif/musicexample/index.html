



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Julia packages for handling and manipulating music-related data.">
      
      
      
        <meta name="author" content="George Datseris, Joel Hobson">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>Music Motifs Example - JuliaMusic</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#ab47bc">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../assets\Documenter.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="purple" data-md-color-accent="pink">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#music-motif-examples" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="JuliaMusic" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                JuliaMusic
              </span>
              <span class="md-header-nav__topic">
                Music Motifs Example
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/JuliaMusic/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="JuliaMusic" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    JuliaMusic
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/JuliaMusic/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../midi/io/" title="MIDI files" class="md-nav__link">
      MIDI files
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../midi/notes/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../mm/quantizing/" title="Quantizing" class="md-nav__link">
      Quantizing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../mm/extraction/" title="Music Data Extraction" class="md-nav__link">
      Music Data Extraction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../printplot/musescore/" title="Printing Notes into Score" class="md-nav__link">
      Printing Notes into Score
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../basic/" title="Motif Sequence Generation" class="md-nav__link">
      Motif Sequence Generation
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Music Motifs Example
      </label>
    
    <a href="./" title="Music Motifs Example" class="md-nav__link md-nav__link--active">
      Music Motifs Example
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#motifs-basic-drum-patterns" title="Motifs: Basic drum patterns" class="md-nav__link">
    Motifs: Basic drum patterns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-the-notes" title="Defining the Notes" class="md-nav__link">
    Defining the Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-alternating-hands-and-lyrics" title="Adding alternating hands and Lyrics" class="md-nav__link">
    Adding alternating hands and Lyrics
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#motifs-basic-drum-patterns" title="Motifs: Basic drum patterns" class="md-nav__link">
    Motifs: Basic drum patterns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-the-notes" title="Defining the Notes" class="md-nav__link">
    Defining the Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-alternating-hands-and-lyrics" title="Adding alternating hands and Lyrics" class="md-nav__link">
    Adding alternating hands and Lyrics
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/JuliaMusic/edit/master/docs/motif/musicexample.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a id='Music-Motif-Examples-1'></a></p>
<h1 id="music-motif-examples">Music Motif Examples</h1>
<p>In this page <a href="../basic/#MotifSequenceGenerator"><code>MotifSequenceGenerator</code></a> is applied in a real world case using the function <a href="./#MusicManipulations.random_notes_sequence"><code>random_notes_sequence</code></a>:</p>
<p><a id='MusicManipulations.random_notes_sequence' href='#MusicManipulations.random_notes_sequence'>#</a>
<strong><code>MusicManipulations.random_notes_sequence</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>random_notes_sequence(motifs::Vector{Notes{N}}, q, δq = 0)
</pre></div>


<p>Create a random sequence from a pool of notes (<code>motifs</code>) such that it has total length <code>ℓ</code> exactly <code>q - δq ≤ ℓ ≤ q + δq</code>.  Notice that <code>q</code> is measured in <strong>ticks</strong>.</p>
<p>Return the result as a single <code>Notes</code> container, and also return the sequence of motifs used.</p>
<p>This function uses <a href="../basic/#MotifSequenceGenerator.random_sequence"><code>random_sequence</code></a> from the module <a href="../@ref"><code>MotifSequenceGenerator</code></a>, adapted to the <a href="../../midi/notes/#MIDI.Notes"><code>Notes</code></a> struct.</p>
<p><a id='Motifs:-Basic-drum-patterns-1'></a></p>
<h2 id="motifs-basic-drum-patterns">Motifs: Basic drum patterns</h2>
<p>Let's say that we have some basic drum patterns that we want to be able to combine freely at random combinations. For example,</p>
<p><img alt="Basic drum patterns" src="../basic_motifs.PNG" /></p>
<p>where the note E means right hand, while A means left hand. These patterns can be easily combined to fill a bar, like for example <code>5b -&gt; 5b -&gt; 3 -&gt; 3</code> or <code>5a -&gt; 4 -&gt; 4 -&gt; 3</code>, etc. They can also be combined to fill two bars and so on. Notice that some sequences, like e.g. the <code>5a -&gt; 4 -&gt; 4 -&gt; 3</code>, result in <em>alternating hands</em>: each time the sequence is played the hand that "leads" is swapped. This will be important later on.</p>
<p>The goal is to be able to play arbitrary sequences of them for arbitrary lengths. How does one practice that? We will use <a href="./#MusicManipulations.random_notes_sequence"><code>random_notes_sequence</code></a> to create longer 8-bar sequences faster with the help of Julia.</p>
<p><a id='Defining-the-Notes-1'></a></p>
<h2 id="defining-the-notes">Defining the <code>Notes</code></h2>
<p>We first have to define the <code>Notes</code> instances that will correspond to those four basic patterns.</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">MusicManipulations</span> <span class="c"># re-exports MIDI</span>

<span class="n">tpq</span> <span class="o">=</span> <span class="mi">960</span> <span class="c"># ticks per quarter note</span>
<span class="n">sixt</span> <span class="o">=</span> <span class="mi">240</span> <span class="c"># duration of sixteenth note</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">name_to_pitch</span><span class="p">(</span><span class="s">&quot;A5&quot;</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">name_to_pitch</span><span class="p">(</span><span class="s">&quot;E6&quot;</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>88
</pre></div>


<p>Reminder: <code>Note(pitch, intensity, start, duration)</code></p>
<div class="codehilite"><pre><span></span><span class="n">motif1</span> <span class="o">=</span> <span class="p">[</span> <span class="c"># motif 5a</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">4</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">motif2</span> <span class="o">=</span> <span class="p">[</span> <span class="c"># motif 5b</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">4</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">motif3</span> <span class="o">=</span> <span class="p">[</span> <span class="c"># motif 3</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">motif4</span> <span class="o">=</span> <span class="p">[</span> <span class="c"># motif 4</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="n">Note</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="n">sixt</span><span class="p">,</span> <span class="n">sixt</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">motifs</span> <span class="o">=</span> <span class="n">Notes</span><span class="o">.</span><span class="p">([</span><span class="n">motif1</span><span class="p">,</span> <span class="n">motif2</span><span class="p">,</span> <span class="n">motif3</span><span class="p">,</span> <span class="n">motif4</span><span class="p">],</span> <span class="n">tpq</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>4-element Array{Notes{Note},1}:
 Notes{Note} with 5 notes
 Notes{Note} with 5 notes
 Notes{Note} with 3 notes
 Notes{Note} with 4 notes
</pre></div>


<p>Now <code>motifs</code> stands for a pool of note sequences we can draw random samples from. Let's generate sequences that are 8-bars long (i.e. 32 quarter notes)</p>
<div class="codehilite"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">tpq</span><span class="o">*</span><span class="mi">32</span>

<span class="n">notes</span><span class="p">,</span> <span class="n">seq</span> <span class="o">=</span> <span class="n">random_notes_sequence</span><span class="p">(</span><span class="n">motifs</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">notes</span>
</pre></div>


<div class="codehilite"><pre><span></span>128 Notes with tpq=960
 Note E6  | vel = 100 | pos = 0, dur = 240
 Note A5  | vel = 50  | pos = 240, dur = 240
 Note E6  | vel = 50  | pos = 480, dur = 240
 Note E6  | vel = 50  | pos = 720, dur = 240
 Note E6  | vel = 100 | pos = 960, dur = 240
 Note A5  | vel = 50  | pos = 1200, dur = 240
 Note A5  | vel = 50  | pos = 1440, dur = 240
  ⋮
 Note A5  | vel = 50  | pos = 29040, dur = 240
 Note A5  | vel = 50  | pos = 29280, dur = 240
 Note E6  | vel = 50  | pos = 29520, dur = 240
 Note E6  | vel = 50  | pos = 29760, dur = 240
 Note E6  | vel = 100 | pos = 30000, dur = 240
 Note A5  | vel = 50  | pos = 30240, dur = 240
 Note A5  | vel = 50  | pos = 30480, dur = 240
</pre></div>


<p>and now we can write these to a MIDI file simply by doing <code>writeMIDIFile("drums_patterns.mid", notes)</code> if we want to. We can also use <a href="https://musescore.org">MuseScore</a>, to visualize and print the result. The function <a href="../../printplot/musescore/#MusicManipulations.MuseScore.musescore"><code>musescore</code></a> provides this interface.</p>
<div class="codehilite"><pre><span></span><span class="n">musescore</span><span class="p">(</span><span class="s">&quot;drums_patterns.png&quot;</span><span class="p">,</span> <span class="n">notes</span><span class="p">)</span>
</pre></div>


<p><img alt="32-bar pattern sequence" src="../drums_patterns.png" /></p>
<p><em>this is a pre-made figure - your random sequence will probably differ</em></p>
<p>This worked nicely, but there is a problem: The sequence does not respect the fact that some specific patterns (<code>5b</code> and <code>4</code>) swap the leading hand. This is what we tackle in the next section.</p>
<p><a id='Adding-alternating-hands-and-Lyrics-1'></a></p>
<h2 id="adding-alternating-hands-and-lyrics">Adding alternating hands and Lyrics</h2>
<p>Notice that <code>random_note_sequence</code> also returns the indices of the motifs that were used to create the sequence:</p>
<div class="codehilite"><pre><span></span><span class="n">seq</span>
</pre></div>


<div class="codehilite"><pre><span></span>31-element Array{Int64,1}:
 4
 2
 2
 1
 2
 1
 1
 2
 3
 3
 ⋮
 1
 3
 4
 4
 4
 4
 4
 2
 3
</pre></div>


<p>We can use this information to put the correct "stickings". To alternate hands we simply need to replace the necessary E notes with A and vice versa. Let's define some "meta-data" like structures</p>
<div class="codehilite"><pre><span></span><span class="n">accent1</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;5a&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="n">accent2</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;5b&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="n">accent3</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="n">accent4</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="n">accents</span> <span class="o">=</span> <span class="p">[</span><span class="n">accent1</span><span class="p">,</span> <span class="n">accent2</span><span class="p">,</span> <span class="n">accent3</span><span class="p">,</span> <span class="n">accent4</span><span class="p">]</span>
</pre></div>


<div class="codehilite"><pre><span></span>4-element Array{Tuple{String,Bool},1}:
 (&quot;5a&quot;, false)
 (&quot;5b&quot;, true)
 (&quot;3&quot;, false)
 (&quot;4&quot;, true)
</pre></div>


<p>The first entry of each tuple is simply the name of the pattern which we will also show in our music score as "lyrics". The second entry of the tuple simply denotes whether the pattern swaps the leading hand.</p>
<p>The function that will "inverse" a note sticking is:</p>
<div class="codehilite"><pre><span></span><span class="n">inverse!</span><span class="p">(</span><span class="n">n</span><span class="o">::</span><span class="n">Note</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">pitch</span> <span class="o">==</span> <span class="n">left</span> <span class="o">?</span> <span class="n">right</span> <span class="o">:</span> <span class="n">left</span><span class="p">));</span>
</pre></div>


<p>The function that will "count" how long is each pattern, so that we put the lyrics on the correct positions in the score, will be:</p>
<div class="codehilite"><pre><span></span><span class="n">note_length</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="n">String</span><span class="p">)</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>


<p>(remember: <code>sixt</code> is the duration of one sixteenth note). We now initialize an empty <a href="../../midi/io/#MIDI.MIDITrack"><code>MIDITrack</code></a> and add all events to it!</p>
<div class="codehilite"><pre><span></span><span class="n">track</span> <span class="o">=</span> <span class="n">MIDITrack</span><span class="p">()</span>
<span class="n">ℓ</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">right_leads</span> <span class="o">=</span> <span class="kc">true</span>

<span class="k">for</span> <span class="n">i</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">accents</span><span class="p">[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">le</span> <span class="o">=</span> <span class="n">textevent</span><span class="p">(</span><span class="o">:</span><span class="n">lyric</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">addevent!</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="n">ℓ</span><span class="o">*</span><span class="n">sixt</span><span class="p">,</span> <span class="n">le</span><span class="p">)</span>

    <span class="k">if</span> <span class="o">!</span><span class="n">right_leads</span> <span class="c"># Invert notes</span>
        <span class="k">for</span> <span class="n">j</span> <span class="kp">in</span> <span class="n">ℓ</span><span class="o">+</span><span class="mi">1</span><span class="o">:</span><span class="n">ℓ</span><span class="o">+</span><span class="n">note_length</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">inverse!</span><span class="p">(</span><span class="n">notes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">end</span>
    <span class="k">end</span>

    <span class="kd">global</span> <span class="n">ℓ</span> <span class="o">+=</span> <span class="n">note_length</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="n">change</span> <span class="o">=</span> <span class="n">accents</span><span class="p">[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="mi">2</span><span class="p">]</span>
    <span class="kd">global</span> <span class="n">right_leads</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">right_leads</span><span class="p">,</span> <span class="n">change</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">addnotes!</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="n">notes</span><span class="p">)</span>
<span class="n">notes</span>
</pre></div>


<div class="codehilite"><pre><span></span>128 Notes with tpq=960
 Note E6  | vel = 100 | pos = 0, dur = 240
 Note A5  | vel = 50  | pos = 240, dur = 240
 Note E6  | vel = 50  | pos = 480, dur = 240
 Note E6  | vel = 50  | pos = 720, dur = 240
 Note A5  | vel = 100 | pos = 960, dur = 240
 Note E6  | vel = 50  | pos = 1200, dur = 240
 Note E6  | vel = 50  | pos = 1440, dur = 240
  ⋮
 Note A5  | vel = 50  | pos = 29040, dur = 240
 Note A5  | vel = 50  | pos = 29280, dur = 240
 Note E6  | vel = 50  | pos = 29520, dur = 240
 Note E6  | vel = 50  | pos = 29760, dur = 240
 Note A5  | vel = 100 | pos = 30000, dur = 240
 Note E6  | vel = 50  | pos = 30240, dur = 240
 Note E6  | vel = 50  | pos = 30480, dur = 240
</pre></div>


<p>Finally, to visualize, we use <a href="../../printplot/musescore/#MusicManipulations.MuseScore.musescore"><code>musescore</code></a> again, using a midi file as an input</p>
<div class="codehilite"><pre><span></span><span class="n">musescore</span><span class="p">(</span><span class="s">&quot;drums_patterns_with_names.png&quot;</span><span class="p">,</span> <span class="n">MIDIFile</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">960</span><span class="p">,</span> <span class="p">[</span><span class="n">track</span><span class="p">]))</span>
</pre></div>


<p><img alt="Correct 32-bar pattern sequence" src="../drums_patterns_with_names.png" /></p>
<p>Isn't it cool that even the lyrics text was displayed so seamlessly?</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../basic/" title="Motif Sequence Generation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Motif Sequence Generation
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/JuliaMusic" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../assets\mathjaxhelper.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>