<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plotting notes · JuliaMusic</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="JuliaMusic logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuliaMusic</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../midi/io/">Basic MIDI structures</a></li><li><a class="tocitem" href="../../midi/notes/">Notes</a></li><li><a class="tocitem" href="../../mm/notetools/">Note Tools</a></li><li><a class="tocitem" href="../../mm/quantizing/">Quantizing &amp; Humanizing</a></li><li><a class="tocitem" href="../../mm/extraction/">Music data extraction</a></li><li><span class="tocitem">Visualization</span><ul><li class="is-active"><a class="tocitem" href>Plotting notes</a><ul class="internal"><li><a class="tocitem" href="#Piano-notes"><span>Piano notes</span></a></li><li><a class="tocitem" href="#Drum-notes"><span>Drum notes</span></a></li></ul></li><li><a class="tocitem" href="../musescore/">Printing notes into a score</a></li></ul></li><li><span class="tocitem">Motif sequence</span><ul><li><a class="tocitem" href="../../motif/basic/">Motif sequence generator</a></li><li><a class="tocitem" href="../../motif/musicexample/">Music motifs</a></li></ul></li><li><span class="tocitem">Becoming a better drummer blog</span><ul><li><a class="tocitem" href="../../blog/drumpatterns/">Ep. 1 - Mixing drum patterns</a></li><li><a class="tocitem" href="../../blog/garibaldi_dragadiddle/">Ep. 2 - Garibaldi inspired dragaddidle</a></li><li><a class="tocitem" href="../../blog/gaddisms/">Ep. 3 - Gaddisms</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Visualization</a></li><li class="is-active"><a href>Plotting notes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plotting notes</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMusic/JuliaMusic_documentation.jl/blob/master/docs/src/printplot/noteplotter.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Plotting-Notes"><a class="docs-heading-anchor" href="#Plotting-Notes">Plotting Notes</a><a id="Plotting-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-Notes" title="Permalink"></a></h1><p>With <code>MusicVisualizations</code> it is possible to plot <a href="../../midi/notes/#MIDI.Notes"><code>Notes</code></a> similarly to a &quot;piano roll&quot; that DAW like Cubase use. This is achieved with the <a href="#MusicVisualizations.noteplotter"><code>noteplotter</code></a> function, which uses <code>PyPlot</code>.</p><article class="docstring"><header><a class="docstring-binding" id="MusicVisualizations.noteplotter" href="#MusicVisualizations.noteplotter"><code>MusicVisualizations.noteplotter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">noteplotter(notes::Notes; kwargs...)</code></pre><p>Plot the given <code>notes</code> on a &quot;piano roll&quot; like setting with</p><ul><li>x axis being the position of the notes</li><li>y axis being the &quot;pitch&quot; or &quot;value&quot; of the notes (see below)</li><li>color being the velocity of the notes</li></ul><p>Then return the values of the y axis.</p><p><strong>Keywords</strong></p><ul><li><code>st = (notes[1].position ÷ notes.tpq) * notes.tpq</code>  time to start plotting from</li><li><code>fi = st + 16notes.tpq</code> time to stop plotting at, by default 16 quarter notes, i.e. four bars. Give <code>Inf</code> if you want to plot until the end of the notes.</li><li><code>ax = (PyPlot.figure(); PyPlot.gca())</code> the axis to plot on.</li><li><code>cmap = &quot;viridis&quot;</code> the colormap to use for the velocity.</li><li><code>grid = 0:0.25:1</code> a grid to plot along with the notes (by default the 16th notes). Give nothing if you don&#39;t want grid lines to be plotted.</li><li><code>names</code> : a dictionary that given the y-axis value returns how this value should be named. By default the function <a href="../../midi/notes/#MIDI.pitch_to_name"><code>pitch_to_name</code></a> is used, along with a heuristic to only name around 7 notes.</li><li><code>plotnote!</code> A function with call arguments <code>plotnote!(ax, note, cmap)</code> (with <code>cmap</code> a colormap instance, not a string), that actually plots the notes. By default plots a &quot;piano-roll&quot;.</li></ul><p>The <code>plotnote!</code> argument allows for customization. The function is supposed to plot a note on the given axis <strong>and return</strong> the &quot;value&quot; of the note. See the official documentation for an example of how this is taken advantage of to e.g. plot drum notes.</p></div></section></article><hr/><h2 id="Piano-notes"><a class="docs-heading-anchor" href="#Piano-notes">Piano notes</a><a id="Piano-notes-1"></a><a class="docs-heading-anchor-permalink" href="#Piano-notes" title="Permalink"></a></h2><pre><code class="language-julia hljs">using MusicVisualizations, PyPlot
# MusicVisualizations reexports MusicManipulations for convenience

# load a band performance (with metronome)
midi = readMIDIFile(joinpath(@__DIR__, &quot;mfi_grapevine_1.mid&quot;))

grid = 0:1//4:1
piano = getnotes(midi, 4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">819 Notes with tpq=960
 Note F4  | vel = 99  | pos = 8981, dur = 1217
 Note A4  | vel = 99  | pos = 8981, dur = 1275
 Note D5  | vel = 97  | pos = 8990, dur = 1314
 Note D3  | vel = 97  | pos = 9004, dur = 1772
 Note D4  | vel = 81  | pos = 9015, dur = 1287
 Note F4  | vel = 84  | pos = 10496, dur = 130
 Note A4  | vel = 87  | pos = 10504, dur = 175
  ⋮
 Note E5  | vel = 87  | pos = 310837, dur = 114
 Note F5  | vel = 81  | pos = 311276, dur = 233
 Note G4  | vel = 82  | pos = 311284, dur = 196
 Note B4  | vel = 58  | pos = 311286, dur = 197
 Note G4  | vel = 92  | pos = 311739, dur = 197
 Note E5  | vel = 99  | pos = 311744, dur = 181
 Note B4  | vel = 56  | pos = 311782, dur = 104</code></pre><pre><code class="language-julia hljs">noteplotter(piano; st = 15300, grid = grid)</code></pre><p><img src="../pianoroll.png" alt/></p><h2 id="Drum-notes"><a class="docs-heading-anchor" href="#Drum-notes">Drum notes</a><a id="Drum-notes-1"></a><a class="docs-heading-anchor-permalink" href="#Drum-notes" title="Permalink"></a></h2><p>The nice thing about <a href="#MusicVisualizations.noteplotter"><code>noteplotter</code></a> is that it is fully customizable, via its argument <code>plotnote!</code>. In this section we show an example of how <a href="#MusicVisualizations.noteplotter"><code>noteplotter</code></a> can be used to plot drum notes in drum notation, similarly to Cubase&#39;s GM Map.</p><p>The first step is defining a specific function for <code>plotnote!</code>. Since the duration of the notes does not have meaning in this case, we can just scatter plot their position. Also, we can use different symbols for different drum parts, e.g. circles for snare and bass drum and Xs for hihat and cymbals.</p><pre><code class="language-julia hljs">function plotdrumnote!(ax, note, cmap)
    p = note.pitch
    if p == 0x24 # kick
        v, m = 1, &quot;o&quot;
    elseif p ∈ (0x26, 0x28) # snare
        v, m = 3, &quot;o&quot;
    elseif p ∈ (0x16, 0x1a) # hihat rim
        v, m = 5, &quot;X&quot;
    elseif p ∈ (0x2e, 0x2a) # hihat head
        v, m = 5, &quot;x&quot;
    elseif p == 0x35 # ride bell
        v, m = 6, &quot;D&quot;
    elseif p == 0x33 # ride head
        v, m = 6, &quot;x&quot;
    elseif p == 0x3b # ride rim
        v, m = 6, &quot;X&quot;
    elseif p ∈ (0x30, 0x32) # tom 1
        v, m = 4, &quot;s&quot;
    elseif p ∈ (0x2b, 0x3a) # tom 3
        v, m = 2, &quot;s&quot;
    elseif p ∈ (0x31, 0x37, 0x34, 0x39)
        v, m = 7, &quot;X&quot;
    elseif p == 0x2c # hihat foot
        v, m = 1, &quot;x&quot;
    else
        error(&quot;Unknown pitch $(UInt8(p))&quot;)
    end
    ax.scatter(note.position, v, marker = m, s = 250,
        color = cmap(min(note.velocity, 127)/127))
    return v
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">plotdrumnote! (generic function with 1 method)</code></pre><p>(notice that the above function is hand-tailored for a specific e-drumset)</p><p>To make things even prettier, one can also use custom names for the notes:</p><pre><code class="language-julia hljs">TD50_PLOT = Dict(
    1 =&gt; &quot;kick&quot;,
    3 =&gt; &quot;snare&quot;,
    5 =&gt; &quot;hihat&quot;,
    6 =&gt; &quot;ride&quot;,
    4 =&gt; &quot;tom1&quot;,
    2 =&gt; &quot;tom3&quot;,
    7 =&gt; &quot;crash&quot;,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Int64, String} with 7 entries:
  5 =&gt; &quot;hihat&quot;
  4 =&gt; &quot;tom1&quot;
  6 =&gt; &quot;ride&quot;
  7 =&gt; &quot;crash&quot;
  2 =&gt; &quot;tom3&quot;
  3 =&gt; &quot;snare&quot;
  1 =&gt; &quot;kick&quot;</code></pre><p>And now here is how plotting some drum notes looks like:</p><pre><code class="language-julia hljs">drums = getnotes(midi, 3)
drums = translate(drums, -300) # constant delay

noteplotter(drums; st = 15300, grid = grid,
                   names=TD50_PLOT, plotnote! = plotdrumnote!)</code></pre><p><img src="../drumroll.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../mm/extraction/">« Music data extraction</a><a class="docs-footer-nextpage" href="../musescore/">Printing notes into a score »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 17 May 2023 13:08">Wednesday 17 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
